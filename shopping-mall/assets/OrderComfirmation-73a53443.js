import{d as I,R as N,ai as w,r as S,E as O,F as b,e as a,N as i,W as s,aQ as k,D as B,H as A,J as D}from"./index-ce5e170b.js";/* empty css              */import{N as L,_ as x}from"./index-95dee2f0.js";import{u as P}from"./useAddCartAnimation-c55e2ead.js";import{O as T}from"./OrderDeliveryAddress-d4156e91.js";import{O as V,a as R}from"./OrderList-cf606a72.js";import{O as E}from"./OrderPayControl-b0443ff0.js";import{g as G,a as q}from"./address-975c59b9.js";import{u as z}from"./user-638b6ecb.js";import{S as F}from"./index-8c74fe71.js";const H={class:"order-comfirmation-page"},J={class:"order-comfirmation-page__main"},Q=I({__name:"OrderComfirmation",setup(U){const l=z(),u=N(),m=w(),{shopId:o}=m.params,{addressId:c}=m.query,d=P(),r=d.getAllCheckedGoodsListByShopId(Number(o));console.log("orderList",r);const p=()=>{history.back()},t=S(null),_=async()=>{try{t.value=await G(l.userInfo.userId)}catch(e){t.value=null}},f=async()=>{try{t.value=await q(Number(c))}catch(e){t.value=null}};(async()=>{c?f():_()})();const n=d.getCartTotalPriceByShopId(Number(o)),h=e=>{d.clearCartCheckedGoodsByShopId(e)},g=async()=>{const e={userId:l.userInfo.userId,shopId:Number(o),shopName:r.shopName,addressId:Number(c),goodsList:r.goodsList,isCanceled:!1};await k({title:"订单支付",message:"点击取消按扭可以取消支付。"}).then(()=>{e.isCanceled=!1}).catch(()=>{e.isCanceled=!0}),await R(e),h(Number(o)),u.push("/order")};return(e,j)=>{const y=D,C=L,v=F;return B(),O("div",H,[b("div",J,[a(v,{"offset-top":0},{default:i(()=>[a(C,{title:"订单确认","left-arrow":"",onClickLeft:p},{right:i(()=>[a(y,{name:"ellipsis",color:"#000",size:"30"})]),_:1})]),_:1}),a(T,{data:t.value},null,8,["data"]),a(V,{data:s(r),show:!1},null,8,["data"]),a(E,{show:!!t.value,"total-price":s(n).nowPriceTotal,"preferential-price":s(n).oldPriceTotal-s(n).nowPriceTotal,onSubmit:g},{default:i(()=>[A(" 确认支付 ")]),_:1},8,["show","total-price","preferential-price"])])])}}});const re=x(Q,[["__scopeId","data-v-d214a0ad"]]);export{re as default};
