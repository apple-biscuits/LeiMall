import{d as k,R as w,ai as O,r as A,a as N,E as _,F as D,e as s,N as l,O as L,P as S,W as P,aQ as x,D as i,V as B,H as b,J as V}from"./index-ce5e170b.js";/* empty css              */import{N as E,_ as T}from"./index-95dee2f0.js";import{u as G}from"./useAddCartAnimation-c55e2ead.js";import{O as R}from"./OrderDeliveryAddress-d4156e91.js";import{a as F,O as q}from"./OrderList-cf606a72.js";import{O as z}from"./OrderPayControl-b0443ff0.js";import{g as H,a as J}from"./address-975c59b9.js";import{u as Q}from"./user-638b6ecb.js";import{S as U}from"./index-8c74fe71.js";const W={class:"order-comfirmation-page"},j={class:"order-comfirmation-page__main"},K=k({__name:"CartOrderComfirmation",setup(M){const o=Q(),p=w(),h=O(),{addressId:u}=h.query,n=G(),m=n.getAllCheckedGoodsList(),v=()=>{history.back()},e=A(null),g=async()=>{try{e.value=await H(o.userInfo.userId)}catch(a){e.value=null}},C=async()=>{try{e.value=await J(o.userInfo.userId,Number(u))}catch(a){e.value=null}};(async()=>{u?C():g()})();const c=N(()=>n.getAllCheckedGoodsPrice()),y=async()=>{var d;const a=[];for(let[t,r]of m)a.push({userId:o.userInfo.userId,shopId:t,shopName:r.shopName,addressId:Number((d=e.value)==null?void 0:d.addressId),goodsList:r.goodsList,isCanceled:!1});await x({title:"订单支付",message:"点击取消按扭可以取消支付。"}).then(()=>{a.forEach(t=>t.isCanceled=!1)}).catch(()=>{a.forEach(t=>t.isCanceled=!0)}),await F(a),n.clearAllCheckedGoodsList(),p.push("/order")};return(a,d)=>{const t=V,r=E,I=U;return i(),_("div",W,[D("div",j,[s(I,{"offset-top":0},{default:l(()=>[s(r,{title:"订单确认","left-arrow":"",onClickLeft:v},{right:l(()=>[s(t,{name:"ellipsis",color:"#000",size:"30"})]),_:1})]),_:1}),s(R,{data:e.value},null,8,["data"]),(i(!0),_(L,null,S(P(m),f=>(i(),B(q,{key:f[0],data:f[1],show:!1},null,8,["data"]))),128)),s(z,{show:!!e.value,"total-price":c.value.nowPriceTotal,"preferential-price":c.value.oldPriceTotal-c.value.nowPriceTotal,onSubmit:y},{default:l(()=>[b(" 确认支付 ")]),_:1},8,["show","total-price","preferential-price"])])])}}});const ce=T(K,[["__scopeId","data-v-97ea9de9"]]);export{ce as default};
